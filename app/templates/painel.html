<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Painel - Corte em Dia</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/painel.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    {% include 'partials/sidebar.html' %}

    <main class="content">
        <div class="header">
            <h1>Painel de Opera√ß√µes</h1>
            <p class="boas-vindas">Bem-vindo(a), <strong>{{ nome_usuario or 'Admin' }}</strong>!</p>
            <p>Unidade: <strong>{{ current_user.unidade_nome or 'N√£o especificada' }}</strong></p>
        </div>

        <section class="kpi-grid">
            <div class="stat-card">
                <div class="card-icon icon-agendamentos">üìÖ</div>
                <div class="card-info">
                    <span class="card-valor">{{ dados_painel.kpi_atendidos_hoje or 0 }} / {{ dados_painel.kpi_agendados_hoje or 0 }}</span>
                    <span class="card-titulo">Atendidos / Agendados</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="card-icon icon-faturamento">üí≤</div>
                <div class="card-info">
                    <span class="card-valor">{{ dados_painel.kpi_faturamento_recebido or 'R$ 0,00' }}</span>
                    <span class="card-titulo">Recebido no Dia</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="card-icon icon-previsao">üí∞</div>
                <div class="card-info">
                    <span class="card-valor">{{ dados_painel.kpi_faturamento_previsto or 'R$ 0,00' }}</span>
                    <span class="card-titulo">Faturamento Previsto</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="card-icon icon-ticket">üéüÔ∏è</div>
                <div class="card-info">
                    <span class="card-valor">{{ dados_painel.kpi_ticket_medio or 'R$ 0,00' }}</span>
                    <span class="card-titulo">Ticket M√©dio do Dia</span>
                </div>
            </div>
        </section>

        <section class="dashboard-grid">
            <div class="main-column">
                <div class="chart-container">
                    <h3>Atendimentos da Semana</h3>
                    <div class="chart-wrapper">  
                        <canvas id="graficoSemana"></canvas>
                    </div>                     
                </div>
            </div>

            <div class="side-column">
                <div class="chart-container">
                    <h3>Faturamento por Profissional (Semana)</h3>
                    <div class="chart-wrapper">  
                        <canvas id="graficoFaturamentoProfissional"></canvas>
                    </div>                     
                </div>
                <div class="table-container">
                    <h3>Desempenho por Profissional (Hoje)</h3>
                    <table class="tabela-desempenho">
                        <thead>
                            <tr>
                                <th>Profissional</th>
                                <th>Atendimentos</th>
                                <th>Faturamento</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for nome, dados in dados_painel.desempenho_hoje.items() %}
                        <tr>
                            <td>{{ nome }}</td>
                            <td>{{ dados.atendidos }} / {{ dados.agendados }}</td>
                            <td>R$ {{ "%.2f"|format(dados.faturamento) | replace('.', ',') }}</td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="3">Nenhum atendimento hoje.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>
    
    <script>
        const DADOS_GRAFICOS = {{ dados_painel | tojson }};
    </script>
    <script src="{{ url_for('static', filename='js/painel.js') }}"></script>
</body>
</html>